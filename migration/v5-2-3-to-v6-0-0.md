# Upgrading from v5.2.3 to v 6.0.0

## Who should apply these changes?
If you created your project from a StartSharp / Serene 6.0.0+ template you don't need to apply changes in this document.

If the project was created earlier from 5.2.3 version, then please first apply migrations earlier migrations listed on left.

StartSharp customers should use [stargen](stargen.md) to automate most of the changes listed here.
Stargen also works on Serene template for this update.

If you are not sure which version of a template your project was created from, you may check your *sergen.json* file. Since version 5.0.19, StartSharp/Serene projects contain information about the initial version of the template under the *UpgradeInfo* section:
 
 ```json
"UpgradeInfo": {
    "InitialType": "Premium",
    "InitialVersion": "5.2.3"
}
```

> If *InitialVersion* is not shown there, it means your initial template version is less than 5.0.19.

## Dotnet Version
Serene or StartSharp project `6.0.0` requires `.NET 6`. You should firstly update your dotnet version to `6.0.0`.

```diff
<Project Sdk="Microsoft.NET.Sdk.Web">
    <PropertyGroup>
-     <TargetFramework>net5.0</TargetFramework>
+     <TargetFramework>net6.0</TargetFramework>

```

## Serenity Package Versions
After upgrade the dotnet version, [update your Serenity package versions](README.md) to `6.0.0` and `6.0.1`.

Your serenity package versions should look like this, ignore the packages which are not exist in your project.

```xml
<PackageReference Include="Serenity.Assets" Version="6.0.0.0" />
<PackageReference Include="Serenity.Scripts" Version="6.0.1.0" />
<PackageReference Include="Serenity.Net.Web" Version="6.0.1.0" />
<PackageReference Include="Serenity.Extensions" Version="6.0.1.0" />
<PackageReference Include="Serenity.Demo.Northwind" Version="6.0.1.0" />
<PackageReference Include="Serenity.Demo.BasicSamples" Version="6.0.1.0" />
<PackageReference Include="Serenity.Demo.AdvancedSamples" Version="6.0.1.0" />

```

Don't forget to update pro packages to `6.0.0` as well.

```xml
<PackageReference Include="Serenity.Pro.Extensions" Version="6.0.1.0" />
<PackageReference Include="Serenity.Pro.Theme" Version="6.0.1.0" />
<PackageReference Include="Serenity.Pro.UI" Version="6.0.1.0" />
<PackageReference Include="Serenity.Pro.DataAuditLog" Version="6.0.1.0" />
<PackageReference Include="Serenity.Pro.DataExplorer" Version="6.0.1.0" />
<PackageReference Include="Serenity.Pro.EmailClient" Version="6.0.1.0" />
<PackageReference Include="Serenity.Pro.EmailQueue" Version="6.0.1.0" />
<PackageReference Include="Serenity.Pro.Organization" Version="6.0.1.0" />
<PackageReference Include="Serenity.Pro.Meeting" Version="6.0.1.0" />
<PackageReference Include="Serenity.Pro.WorkLog" Version="6.0.1.0" />
```

## Updating Other packages

Please check any other packages you have installed and update them for the `.net 6` version. Here is mandatory packages you should update.

```xml
<PackageReference Include="FluentMigrator.Runner" Version="3.3.2" />
<PackageReference Include="Microsoft.AspNetCore.Mvc.NewtonsoftJson" Version="6.0.2" />
<PackageReference Include="Microsoft.AspNetCore.Mvc.Razor.RuntimeCompilation" Version="6.0.2" />
<PackageReference Include="Microsoft.Data.Sqlite" Version="6.0.3" />
<PackageReference Include="Microsoft.TypeScript.MSBuild" Version="4.6.2">
    <PrivateAssets>all</PrivateAssets>
    <IncludeAssets>runtime; build; native; contentfiles; analyzers</IncludeAssets>
</PackageReference>
```

### Updating sergen.json

Check your `sergen.json` file and the `ServerTypings` section. If you don't have this section, you can add it to your `sergen.json` file. This configuration is to generating the local text typescript files for intellisense. This files are contains long text values which will cause conflict while you are doing a merge in source control. Also this text files are not necessary to load in browser. We can exclude this local texts. But to backward compatibility, we added an option for users to able decide to generate them or not. You can exclude or include them by adding this configuration to your `sergen.json` file. When value is `true`, it will generate the local texts. When value is `false`, it will not generate the local texts for typescript. If you didn't add this configuration, it will not generate the local texts.

```json
{
  "RootNamespace": "StartSharpTest",
  "ServerTypings": {
    "LocalTexts": true
  },
  ...
}
```

### Updating the code files

There is one mandatory change in the code files. You should fix the `MD5CryptoServiceProvider` usages. This class is not available in .NET 6. You should use `MD5` class instead. The changes should applied to the `UserEndpoint.cs` and `AccountPage.cs` files.

```diff
-   var md5 = new MD5CryptoServiceProvider();
+   var md5 = MD5.Create();
```
